<Window x:Class="MemoryGame.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Memory Game" Height="520" Width="420">
    <DockPanel Margin="12">
        <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="0 0 0 10">
            <TextBlock Text="Username:" VerticalAlignment="Center"/>
            <TextBox Width="120" Text="{Binding Username, UpdateSourceTrigger=PropertyChanged}"/>
            <Button Content="Start" Command="{Binding StartCommand}" />
            <TextBlock Text="Moves:" Margin="12,0,4,0" VerticalAlignment="Center"/>
            <TextBlock Text="{Binding Moves}" VerticalAlignment="Center"/>
            <TextBlock Text="Time:" Margin="12,0,4,0" VerticalAlignment="Center"/>
            <TextBlock Text="{Binding Elapsed}" VerticalAlignment="Center"/>
        </StackPanel>

        <ItemsControl ItemsSource="{Binding Cards}">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <UniformGrid Rows="4" Columns="4"/>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>

            <ItemsControl.ItemTemplate>
                <DataTemplate DataType="{x:Type vm:CardViewModel}" xmlns:vm="clr-namespace:MemoryGame.UI.ViewModels">
                    <Button Padding="0" FontSize="28" Command="{Binding DataContext.FlipCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                            CommandParameter="{Binding Id}" MinWidth="80" MinHeight="80">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border CornerRadius="8" Background="#2b2b2b" BorderBrush="#444" BorderThickness="1">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                        <Button.Content>
                            <TextBlock x:Name="SymbolText" Text="🂠" />
                        </Button.Content>
                        <Button.Style>
                            <Style TargetType="Button">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsMatched}" Value="True">
                                        <Setter Property="IsEnabled" Value="False"/>
                                        <Setter Property="Foreground" Value="#6cff9b"/>
                                        <Setter Property="Content">
                                            <Setter.Value>
                                                <TextBlock Text="{Binding Symbol}" />
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding IsFlipped}" Value="True">
                                        <Setter Property="Content">
                                            <Setter.Value>
                                                <TextBlock Text="{Binding Symbol}" />
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </DockPanel>
</Window>